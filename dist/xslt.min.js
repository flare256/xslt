(function(){var P=[].slice,A=[].indexOf||function(e){for(var n=0,r=this.length;n<r;n++){if(n in this&&this[n]===e)return n}return-1};(function(e,n){if(typeof define==="function"&&define.amd!=null){return define([],function(){return n(e)})}else if(typeof(typeof module!=="undefined"&&module!==null?module.exports:void 0)==="object"){return module.exports=n(e)}else{return e!=null?e.xslt=n(e):void 0}})(this,function(e){var m,d,s,p,c,f,r,v,t,x,g,M,n,D,l,h,y,u,o,N,i,E,a,O,X,L,S,T,w,z,b,F,H;X={xmlNode:function(){return/<([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*(\/?)>/i},xmlLike:function(){return/^\s*</},xmlHeader:function(){return/^\s*<\?xml\b[^<]+/i},namespaces:function(){return/\bxmlns(?::([a-z0-9:\-]+))?\s*=\s*"([^"]*)"/gi}};o=function(e){return X.xmlLike().test(e)};u=function(e){return X.xmlHeader().test(e)};E=function(e){return o(e)&&!u(e)};H=function(e,n){var r;r='<?xml version="1.0" ';if(e!=null){r+='encoding="'+e+'" '}if(n!=null){r+='standalone="'+n+'" '}r+="?>";return r};O=function(e,n,r){return H(n,r)+e};w=function(e){return e!=null?e.replace(X.xmlHeader(),""):void 0};l=function(e){var n,r;n=e!=null?e.match(X.xmlHeader()):void 0;return(n!=null?n.length:void 0)&&((r=n[0])!=null?typeof r.trim==="function"?r.trim():void 0:void 0)||null};n=function(e,n){var r;r=new RegExp("\\b"+n+'\\s*=\\s*"([^"]*)"',"g").exec(e);return(r!=null?r.length:void 0)>1&&r[1]||null};h=function(e){return n(l(e),"encoding")};y=function(e){return n(l(e),"standalone")};d=typeof ActiveXObject!=="undefined"&&ActiveXObject!==null||"ActiveXObject"in e;F=function(){var e,n,r,t;t=1<=arguments.length?P.call(arguments,0):[];if(!d){return null}for(e=0,r=t.length;e<r;e++){n=t[e];try{return new ActiveXObject(n)}catch(e){}}return null};r=function(){var e;e=F.apply(null,["Msxml2.FreeThreadedDOMDocument.6.0","Msxml2.FreeThreadedDOMDocument.3.0","Msxml2.FreeThreadedDOMDocument","Microsoft.XMLDOM","Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument"]);if(e!=null){e.async=false;while(e.readyState!==4){null}}return e};v=function(){return F.apply(null,["Msxml2.XSLTemplate.6.0","Msxml2.XSLTemplate"])};i=function(){var e,n;n=document.createElement("xml");n.src=H();document.body.appendChild(n);e=n.XMLDocument;document.body.removeChild(n);return e};a=function(){var e,n;e=null;if(e==null){e=r()}if(typeof DOMParser!=="undefined"&&DOMParser!==null){return e}if(e==null){e=i()}if(e==null){e=(n=document.implementation)!=null?typeof n.createDocument==="function"?n.createDocument("","test",null):void 0:void 0}return e};L=function(e){var n,r,t,l,u;if(e instanceof"XMLDocument"){return e}if(typeof e!=="string"||!o(e)){return null}if(E(e)){e=O(e)}n=a();if(n!=null&&"loadXML"in n){n.loadXML(e);if(n.documentElement==null||((r=n.parseError)!=null?r.errorCode:void 0)!==0){throw new Error("loadXML error: "+n.parseError)}}else if(n!=null&&"load"in n){n.load(e)}else if(typeof DOMParser!=="undefined"&&DOMParser!==null){n=(t=new DOMParser)!=null?typeof t.parseFromString==="function"?t.parseFromString(e,"text/xml"):void 0:void 0;if((n!=null?typeof n.getElementsByTagName==="function"?(l=n.getElementsByTagName("parsererror"))!=null?l.length:void 0:void 0:void 0)>0||(n!=null?(u=n.documentElement)!=null?u.nodeName:void 0:void 0)==="parsererror"){throw new Error("Failed to load document from string:\r\n"+n.documentElement.textContent)}}return n};x=function(e){var n,r;if(e==null){return null}r=typeof e==="string"?e:(e!=null?e.xml:void 0)!=null?e.xml:typeof XMLSerializer!=="undefined"&&XMLSerializer!==null?(n=new XMLSerializer)!=null?typeof n.serializeToString==="function"?n.serializeToString(e):void 0:void 0:null;if((r!=null?typeof r.indexOf==="function"?r.indexOf("<transformiix::result"):void 0:void 0)>=0){r=r.substring(r.indexOf(">")+1,r.lastIndexOf("<"))}return r};D=function(e,n){var r,t,l,u,o,i,a,c,f;t=/\s([a-z0-9:\-]+)\s*=\s*("([^"]*)"|'([^']*)')/gi;l={};while(c=t.exec(e)){r=c[0],i=c[1],a=c[2],u=c[3],o=c[4];f={outer:a,inner:u||o};if(!(typeof n==="function"?n(i,f):void 0)){l[i]=f}}return l};s=function(e,n,r){var t,l,u;if(n==null){n={}}if(r==null){r=""}t="<"+e;for(l in n){u=n[l];t+=" "+l+"="+u.outer}t+=r+">";return t};p=function(e,n,r,t){var l,u,o,i,a,c,f;u=D(e,function(e,n){var r;return/^xmlns/.test(e)&&(r=n.inner,A.call(t.excludedNamespaceUris,r)>=0)});a=t.includeNamespaces;for(i in a){c=a[i];if(A.call(function(){var e;e=[];for(o in u){f=u[o];e.push(f.inner)}return e}(),c)<0){l="xmlns";if(i.length){l+=":"+i}u[l]={outer:'"'+c+'"',inner:c}}}return s(n,u,r)};T=function(e,n,r,t){var l;if(t==null){t=[]}l=D(e,function(e,n){var r;return r=n.inner,A.call(t,r)>=0});return s(n,l,r)};b=function(e){return e.replace(/xmlns\s*=\s*""/gi,"")};S=function(e){return e.replace(X.namespaces(),"")};z=function(e){var n,r,t,l;l=[];e=e.replace(/xmlns:NS([0-9]+)=""/gi,function(e,n){l.push(n);return""});for(n=0,r=l.length;n<r;n++){t=l[n];e=e.replace(new RegExp("NS"+t+":xmlns:","g"),"xmlns:")}return e};M=function(e,t){var l;if(t==null){t=[]}l={};e=e!=null?e.replace(X.namespaces(),function(e,n,r){if(n==null){n=""}if(l[n]!=null&&l[n]!==r){return e}if(A.call(t,r)>=0){return""}l[n]=r;return""}):void 0;return{xml:e,ns:l}};c=function(e,f){var s,m;m=[];s=true;return e!=null?e.replace(new RegExp(X.xmlNode().source,"gi"),function(e,n,r){var t,l,u,o,i,a,c;if(f.removeNamespacedNamespace){e=z(e)}if(f.removeNullNamespace){e=b(e)}if(f.removeAllNamespaces){e=S(e)}if(s){s=false;e=p(e,n,r,f);i=D(e,function(e){return!/^xmlns/.test(e)});m=function(){var e;e=[];for(u in i){c=i[u];e.push(c.inner)}return e}();o=f.excludedNamespaceUris;for(t=0,l=o.length;t<l;t++){a=o[t];m.push(a)}}else{if(f.removeDupAttrs||f.removeDupNamespace){e=T(e,n,r,m)}}return e}):void 0};f=function(e){return e!=null?e.replace(/<(([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*)><\/\2>/gi,function(e,n){return"<"+n+"/>"}):void 0};g=function(e){return e!=null?e.replace(/<(([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*)\/>/gi,function(e,n,r){return"<"+n+"></"+r+">"}):void 0};t={fullDocument:false,cleanup:true,xmlHeaderInOutput:true,normalizeHeader:true,encoding:"UTF-8",preserveEncoding:false,collapseEmptyElements:true,expandCollapsedElements:false,removeDupNamespace:true,removeDupAttrs:true,removeNullNamespace:true,removeAllNamespaces:false,removeNamespacedNamespace:true,includeNamespaces:{},excludedNamespaceUris:[],moveNamespacesToRoot:false};N=function(e){var n,r;n={};for(r in t){n[r]=t[r]}if(e!=null){for(r in e){n[r]=e[r]}}return n};m=function(e,n,r){var t,l,u,o,i,a,c,f,s;t=N(r);a=L(e);if(a==null){throw new Error("Failed to load the XML document")}s=L(n);if(s==null){throw new Error("Failed to load the XSLT document")}if(typeof XSLTProcessor!=="undefined"&&XSLTProcessor!==null&&(typeof document!=="undefined"&&document!==null?(o=document.implementation)!=null?o.createDocument:void 0:void 0)!=null){u=new XSLTProcessor;u.importStylesheet(s);i=t.fullDocument?u.transformToDocument(a):u.transformToFragment(a,document)}else if("transformNode"in a){i=a.transformNode(s)}else if(d){f=v();f.stylesheet=s;c=f.createProcessor();c.input=a;c.transform();i=c.output}l=x(i);if(t.preserveEncoding){t.encoding=h(l)||h(e)||t.encoding}if(t.cleanup){l=m.cleanup(l,t)}return l};m.cleanup=function(e,n){var r,t,l,u,o,i,a;l=N(n);if(!l.cleanup){return}if(l.preserveEncoding){l.encoding=h(e)||l.encoding}i=y(e);if(l.normalizeHeader||!l.xmlHeaderInOutput){e=w(e)}if(l.xmlHeaderInOutput&&E(e)){e=O(e,l.encoding,i)}if(l.moveNamespacesToRoot){u=M(e,l.excludedNamespaceUris),t=u.ns,e=u.xml;o=l.includeNamespaces;for(r in o){a=o[r];t[r]=a}l.includeNamespaces=t}e=c(e,l);if(l.collapseEmptyElements&&!l.expandCollapsedElements){e=f(e)}if(l.expandCollapsedElements&&!l.collapseEmptyElements){e=g(e)}return e};m.strToDoc=function(e){return L(e)};return m})}).call(this);